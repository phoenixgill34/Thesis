\chapter{Introduction}
\label{ch:introduction}
\section{Motivation}
Gradually we are moving towards context awareness among automotive devices where the vehicles are aware of their neighborhood. In modern railway applications, a huge amount of wireless communications is used for safety features such as train collision avoidance and railway management. To enhance reliability and safety of Railway systems, while increasing accessibility and productivity, modern railway operations rely on an ever increasing amount of exchange of information between different trains, i.e., train-to-train (T2T) and train-to-ground (T2G). The integration of all of these heterogeneous wireless networks deployed in the railway domain constitutes a key technical challenge. These challenges can potentially be answered by Cognitive Radio (CR) technologies, which can offer interoperability, reliability, dynamic spectrum access, and both lower deployment and maintenance costs. Two research projects currently underway for cognitive radio enabled railway communication include the following:

\begin{itemize}

\item Cognitive Radio for Railway Through Dynamic and Opportunistic Spectrum Reuse (CORRIDOR)~\cite{corridor} is a French research project that targets opportunistic spectrum access for railways. Due to the rapid increase in demand for future railways in terms of control operations as well as providing high speed internet connectivity to the passengers, more bandwidth and spectrum is needed for railway communications.

\item Rail-CR project~\cite{5621621} is a US-based railway system project where the main effort is focused on implementing a positive train control (PTC) technology designed to equip trains with wireless communication capabilities. The project aims to allow trains to communicate with wayside wireless stations while moving to supply important information such as speed and direction in order to improve safety and operations of the railway system.

\end{itemize}

In this thesis, we have designed and implemented two prototypes to further the advancement of smart railway communication systems. In the first test-bed, we have analyzed the performance of high speed train (HST) systems in a tunnel environment. In recent years, the use of trains have witnessed tremendous growth due to their high speeds, which has led to the demand for reliable wireless communication systems with these transportation systems. The development of a reliable wireless network for high speed trains is not a simple task and it is still an emerging technology. Global System for Mobile Communication for Railways (GSM-R)~\cite{trlter1}, was a wireless communications standard designed for high speed trains, but it turned out not to be reliable enough and possess several limitations. Subsequently, LTE-R~\cite{trlter2} proposed a promising solution for achieving broadband data rates in high speed trains that can overcome various GSM-R limitations~\cite{arlter3,inplter4}. 

LTE-R is a high speed communication standard based on the existing LTE system architecture~\cite{inplter4}. There has been several studies regarding the assessment of LTE-R as a viable choice for next generation high speed communications for railway applications~\cite{inplter5,inplter6}. Most LTE systems operate at 1.8 GHz -- 2.6 GHz bands, which possesses a high propagation loss and severe fading effects. Highly mobile trains inside tunnel environments makes the design of reliable communication links very challenging. To achieve reliable radio coverage inside tunnels, leaky feeder cables have been proposed~\cite{arlter7}. With LCX, more uniform coverage can be achieved and installation is also comparatively simple. Each slot in the cable is equivalent to an antenna, which can transmit and receive signals. Figure~\ref{fig:ltertunnel} shows the LOS propagation environment inside a tunnel for a high speed train with velocity $v$.
  
\begin{figure}[!ht]
\centering
\includegraphics[width=0.8\textwidth,keepaspectratio]{images/Gill/lte_figs/3dtunnel.eps} 
\caption{High speed train inside a tunnel for LTE-R. $D_{LOS}$ is the distance between transmitter and receiver, $d$ is the distance between the LCX cable transmission slots.}
\label{fig:ltertunnel}
\end{figure}

The second proposed contribution of this thesis is the design and implementation of a GNU Radio based software-defined radio network performing cooperative spectrum sensing. Smart railway communication system requires large bandwidth in order to support the high data-rate applications. This has facilitated the research in dynamic spectrum access (DSA)~\cite{arhtn2,arhtn3} for efficient utilization of spectrum resources to sustain billions of Internet of Things (IoT) devices. There has been a significant increase in the study of cognitive radios for efficiently utilizing the electromagnetic spectrum. It has been observed that the spectrum occupancy is not uniform across all frequency bands, resulting in numerous spectral white spaces~\cite{bookhtn1}. To opportunistically access these idle channels, spectrum sensing is considered to be a significant technology for enabling DSA. Although several spectrum sensing techniques have been proposed in the open literature, energy detection is widely used due to its low implementation complexity~\cite{arhtn4}. We discuss some of the spectrum sensing techniques along with energy detection below:
\begin{itemize}
\item In \textit{energy detection} (ED), the energy of the signal is detected in the frequency location and based on the threshold value we decide whether the signal is present or absent.

\item \textit{Cyclostationary Feature Detection} is a complex scheme to implement compared to ED and it is mostly used when we need to also classify the signal present based on their modulation scheme.

\item When secondary user has \textit{apriori} knowledge of primary user signal, \textit{matched  filter} (MF)  detection  is  applied. Detection by using matched filter needs less detection time compared to ED but primary user information is required.
\end{itemize}

These spectrum sensing techniques can be used in a non-cooperative manner but it is very challenging to get an accurate estimate using a single-sensor system within a practical fading environment. Various non-idealities, such as shadowing, multipath, and fluctuating noise variance, can make it difficult to detect the primary user~\cite{inphtn5,inphtn6}. Cooperative spectrum sensing can mitigate the effects of multipath and shadowing by utilizing the spatial and temporal diversity of a multiple radio network~\cite{inphtn7,inphtn8}. In cooperative spectrum sensing, each sensor node collects the spectral data and transmits it to a fusion center (FC) for decision making. Figure~\ref{fig:css} shows how a heterogeneous sensor network exploits the spatial diversity. 

\begin{figure}[!ht]
\centering
\includegraphics[width=\textwidth,keepaspectratio]{images/Gill/figs/introdiag.eps} 
\caption{Heterogeneous sensor network employing cooperative spectrum sensing. $RFFE_i$ and $SR_i$ represents different front end and sampling rates for the SDR units.}
\label{fig:css}
\end{figure}

\section{State of the Art}

In the open literature, most channel modeling techniques have considered open areas for high speed trains~\cite{inplter5,inplter6}, while relatively little research has been conducted for trains operating in tunnel environments. Due to various challenges presented by tunnel environments, it is important to derive a channel model for LTE-R involving high speed trains. In this thesis, we analyze the effects of high Doppler shift and multipath propagation due to tunnel environments. Experimental studies conducted inside tunnel environments have shown that the field amplitude distribution fits smoothly over a Rician distribution~\cite{inplter8}. Several research efforts have been conducted for large-scale and small-scale fading characteristics for wideband communication systems inside tunnel environments. To the best of the authorâ€™s knowledge, none of these studies have been conducted for LTE-R, which employs Orthogonal Frequency Division Multiplexing (OFDM) signals for data transmission inside tunnels. The large Doppler shifts caused by high speed trains will potentially lead to ambiguity when extracting the carrier frequency, which can potentially increase the BER~\cite{inplter9}. Therefore, it is important to study the effects of high Doppler shift and multipath fading for LTE-R communications in tunnel environments such that equalizers can be design efficiently.

% Heterogeneous Networks state-of-the-art..
The cooperative spectrum sensing testbed using normalized energy detection has been implemented and and compared with both soft and hard data fusion schemes. Both soft data fusion and hard data fusion have been extensively studied in the literature~\cite{arhtn9,inphtn10,arhtn11}, with several algorithms being implemented for each scheme. In a hard decision approach, each local decision statistic from a sensor node is transmitted to an fusion center (FC) via overhead channels. The FC merges the sensing data and makes a global decision based on various algorithms such as majority rule, OR rule, and AND rule~\cite{inhtn12}. For a soft decision scheme, each sensor unit (SU) sends its local sensing data to the FC, which makes decision based on a global test statistic $G$. Soft decision combining improves the cooperative gain but it also possesses several limitations. With an infinite bandwidth, the real floating values can be transmitted to the FC, which can lead to a reliable decision mechanism. However, due to bandwidth constraints we have to quantize the data and this leads to error in the energy values. In hard decision combining, we can just transmit the decisions of the sensor nodes to the FC, which can be binary values where ''1'' indicating that signal source is present and ''0'' indicating that a signal source is absent.
\section{Thesis Contributions}
This thesis possesses the following contribution to the cognitive radio communications and railway communications field:

\begin{itemize}
\item A performance assessment and simulation of LTE-R communications in a tunnel environment experiencing severe fading.

\item Dynamic K-factor for a tunnel environment is derived using the classical two-ray propagation model~\cite{booklter11} and is used to build Rician fading model for the tunnel.

\item A cooperative spectrum sensing hardware prototype with normalized energy detection using both soft data fusion and hard data fusion implemented on available software defined radios.

\item For soft data fusion, Maximum Normalized Energy (MNE) and Equal Gain Combination (EGC) algorithms are used. Hard data fusion is also implemented using majority rule, AND, and OR approaches. Both USRP N210s~\cite{usrp} and RTL-SDRs~\cite{rtlsdr} are employed for the implementation of the heterogeneous sensor network.
\end{itemize}


\section{Thesis Organization}
This thesis is organized into the following chapters: Chapter~\ref{chapter2} discusses the smart railway communication system in detail and provides necessary understanding of LTE-R communication system, positive train control (PTC), wireless broadband (WiBro), spectrum regulation. Chapter~\ref{chapter3} provides background knowledge on heterogeneous cooperative spectrum sensing and focuses on heterogeneous networks, cooperative spectrum sensing, and software-defined radios. Chapter~\ref{chapter4} discusses the proposed LTE-R implementation and its results in a tunnel environment. Channel impairments and two-ray propagation model are also discussed in details.  In Chapter~\ref{chapter5}, the proposed implementation of a heterogeneous cooperative spectrum sensing (CSS) test-bed and results are discussed. Chapter~\ref{conclusion} concludes this thesis, summarizing the accomplishments and outlines possible future work.

\section{List of Related Publications}
The following publications resulted from the activities of this thesis research:
\begin{itemize}
\item K. S. Gill and A. M. Wyglinski, "Heterogeneous Cooperative Spectrum Sensing
Test-Bed Using Software-Defined Radios," in Vehicular Technology Conference (VTC Fall), 2017 IEEE 86th, Sept 2017.

\item K. S. Gill, P.V.R Ferreira and A. M. Wyglinski, "Performance Analysis of High Speed Railways Communications Inside a Tunnel Using LTE-R," in Vehicular Technology Conference (VTC Fall), 2017 IEEE 86th, Sept 2017.

\end{itemize}


